{% load widget_tweaks %}
{% load static %}

MIERDA

<div class="tab-pane fade" id="tab-recursos" role="tabpanel">


          <hr class="my-4">
        <div class="card radius-10">
          <div class="card-body" >
    <div class="row">
          <div class="col-12 col-xl-8 d-flex">
            <div class="card radius-10 w-100">
              <div class="card-body" style="background-color: rgb(46, 46, 46);border-radius: 25px;">
                                                 <div class="country-icon">
                            <img src="assets/images/icons/india.png" alt="" width="32">
                          </div>


                      
                 <h5>Investigación y Desarollo (I+D): {{ project.name }}</h5>


                                        <div class="d-flex flex-column flex-lg-row align-items-lg-center align-self-end justify-content-lg-between border p-3 gap-3 mb-0 rounded-3">
                <div class="d-flex align-items-center gap-3">
                  <div class="widget-icon rounded-circle bg-light-success text-success">
                   <ion-icon name="git-network-outline"></ion-icon>
                  </div>
                  <div class="">
                    <h4 class="mb-0">29</h4>
                    <p class="mb-0 text-secondary">Total Porcesos</p>
               
                  </div>
                </div>
                <div class="vr d-none d-lg-block"></div>
                <div class="d-flex align-items-center gap-3">
                  <div class="widget-icon rounded-circle  bg-light-success text-success">
                     <ion-icon name="code-slash-outline"></ion-icon>
                  </div>
                  <div class="">
                    <h4 class="mb-0">8</h4>
                    <p class="mb-0 text-secondary">En Desarollo(87%)</p>
             
                  </div>
                </div>
                <div class="vr d-none d-lg-block"></div>
                <div class="d-flex align-items-center gap-3">
                  <div class="widget-icon rounded-circle  bg-light-success text-success">
                    <ion-icon name="checkmark-done-outline"></ion-icon>
                  </div>
                  <div class="">
                    <h4 class="mb-0">29</h4>
                    <p class="mb-0 text-secondary">Completados </p>
               
                  </div>
                </div>
              </div>

    

         
                 

               <div class="row g-4 align-items-center mb-4" >
                  <div class="col-12 col-xl-12" style="max-height: 300px; overflow-y: auto;margin-top: 79px;">

                         
                                <div class="d-flex align-items-start">
                                  <div class="review-user">
                                    <img src="assets/images/avatars/01.png" width="65" height="65" class="rounded-circle" alt="" />
                                  </div>
                                  <div class="review-content ms-3">
                                     <div class="progress mb-3" style="height:7px;">
									<div class="progress-bar progress-bar-striped bg-warning" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
								</div>
                                    <div class="d-flex align-items-center mb-2">
                                      <h6 class="mb-0">James Caviness  <ion-icon name="git-network-outline"></ion-icon>
                                       <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-cpu"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><rect x="9" y="9" width="6" height="6"></rect><line x1="9" y1="1" x2="9" y2="4"></line><line x1="15" y1="1" x2="15" y2="4"></line><line x1="9" y1="20" x2="9" y2="23"></line><line x1="15" y1="20" x2="15" y2="23"></line><line x1="20" y1="9" x2="23" y2="9"></line><line x1="20" y1="14" x2="23" y2="14"></line><line x1="1" y1="9" x2="4" y2="9"></line><line x1="1" y1="14" x2="4" y2="14"></line></svg>
                                        <i class="fadeIn animated bx bx-bot"></i>
                                         <span class="spinner-border spinner-border-sm text-warning"></span>
                                         <ion-icon name="checkmark-done-circle-outline"></ion-icon>
                                      </h6>
                                    </div>
                                      <div class="d-flex align-items-center mb-2">
                                      <h6 class="mb-0">February 16, 2021</h6>
                                     
                                    </div>
                                    <p>Nesciunt tofu stumptown aliqua, retro synth master cleanse. Mustache cliche tempor, williamsburg carles vegan helvetica. Reprehenderit butcher retro keffiyeh dreamcatcher synth. Cosby sweater eu banh mi, qui irure terry richardson ex squid. Aliquip placeat salvia cillum iphone. Seitan aliquip quis cardigan</p>
                                  </div>
                                </div>
                                <hr/>
                                <div class="d-flex align-items-start">
                                  <div class="review-user">
                                    <img src="assets/images/avatars/02.png" width="65" height="65" class="rounded-circle" alt="" />
                                  </div>
                                  <div class="review-content ms-3">
                                  
                                    <div class="d-flex align-items-center mb-2">
                                      <h6 class="mb-0">David Buckley</h6>
                                      <p class="mb-0 ms-auto">February 22, 2021</p>
                                    </div>
                                    <p>Nesciunt tofu stumptown aliqua, retro synth master cleanse. Mustache cliche tempor, williamsburg carles vegan helvetica. Reprehenderit butcher retro keffiyeh dreamcatcher synth. Aliquip placeat salvia cillum iphone. Seitan aliquip quis cardigan</p>
                                  </div>
                                </div>
                                <hr/>
                                <div class="d-flex align-items-start">
                                  <div class="review-user">
                                    <img src="assets/images/avatars/03.png" width="65" height="65" class="rounded-circle" alt="" />
                                  </div>
                                  <div class="review-content ms-3">
                                    <div class="rates cursor-pointer fs-6">	<i class="bx bxs-star text-warning"></i>
                                      <i class="bx bxs-star text-warning"></i>
                                      <i class="bx bxs-star text-warning"></i>
                                      <i class="bx bxs-star text-warning"></i>
                                      <i class="bx bxs-star"></i>
                                    </div>
                                    <div class="d-flex align-items-center mb-2">
                                      <h6 class="mb-0">Peter Costanzo</h6>
                                      <p class="mb-0 ms-auto">February 26, 2021</p>
                                    </div>
                                    <p>Nesciunt tofu stumptown aliqua, retro synth master cleanse. Mustache cliche tempor, williamsburg carles vegan helvetica. Reprehenderit butcher retro keffiyeh dreamcatcher synth. Cosby sweater eu banh mi, qui irure terry richardson ex squid.</p>
                                  </div>
                                </div>
                          
                  </div>

               </div><!--end row-->

              </div>
            </div>
          </div>
          <div class="col-12 col-xl-4 d-flex">

            
            
            <div class="card radius-10 overflow-hidden w-100">
              <div class="card-body" style="background-color: rgb(46, 46, 46);border-radius: 25px;">

<div class="card radius-10 w-100">
  <div class="card-body">
    
    <div class="d-flex align-items-center mb-3">
      <h5 class="mb-0">Equipo SmartQuail Responsable</h5>
    </div>

    <!-- CONTENEDOR HORIZONTAL -->
    <div class="d-flex gap-4">

      <div class="review-user text-center">
        <img src="assets/images/avatars/01.png" width="65" height="65" class="rounded-circle" alt="" />
        <p class="mb-0 fw-bold" style="font-size: 13px;">Mauricio Silva</p>
        <p class="mb-0 text-muted" style="font-size: 9px;">Project Manager</p>
      </div>

      <div class="review-user text-center">
        <img src="assets/images/avatars/01.png" width="65" height="65" class="rounded-circle" alt="" />
        <p class="mb-0 fw-bold" style="font-size: 13px;">Mauricio Silva</p>
        <p class="mb-0 text-muted" style="font-size: 9px;">Desarolladorr</p>
      </div>

            <div class="review-user text-center">
        <img src="assets/images/avatars/01.png" width="65" height="65" class="rounded-circle" alt="" />
        <p class="mb-0 fw-bold" style="font-size: 13px;">Mauricio Silva</p>
        <p class="mb-0 text-muted" style="font-size: 9px;">Ingeniero de IA</p>
      </div>


    </div>
    <!-- FIN CONTENEDOR HORIZONTAL -->

  </div>
</div>


                <div class="d-flex flex-column gap-3">
                  <div class="card border shadow-none radius-10 flex-grow-1 mb-0">
                    <div class="card-body">
                      <div class="d-flex align-items-start gap-2">
                        <div>
                          <h5 class="mb-0 "> <ion-icon name="git-network-outline"></ion-icon>Automatizados</h5>
                        </div>
                        <div class="ms-auto widget-icon-2 bg-light-success text-success rounded-circle">
                         <i class="fadeIn animated bx bx-bot"></i>
                        </div>
                      </div>
                      <div class="">
                        <h3 class="mb-2">9 </h3>
                         <p>Implementados(87%)</p>
                        <div class="d-flex align-items-center gap-2">
                           <div class="widget-icon-small bg-light-danger text-danger">
                            +A
                           </div>
                                                   <div class="progress flex-grow-1" style="height: 5px;">
                            <div class="progress-bar bg-gradient-info" role="progressbar" style="width: 82%;"></div>
                          </div>
                        </div>
                      </div>
                    
                    </div>
                  </div>
                  <div class="card border shadow-none radius-10 mb-0">
                    <div class="card-body">
                      <div class="d-flex align-items-start gap-2">
                        <div>
                          <h5 class="mb-0 ">  <ion-icon name="git-network-outline"></ion-icon> Agentes AI/ML</h5>
                        </div>
                        <div class="ms-auto widget-icon-2 bg-light-success text-success rounded-circle">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-cpu"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><rect x="9" y="9" width="6" height="6"></rect><line x1="9" y1="1" x2="9" y2="4"></line><line x1="15" y1="1" x2="15" y2="4"></line><line x1="9" y1="20" x2="9" y2="23"></line><line x1="15" y1="20" x2="15" y2="23"></line><line x1="20" y1="9" x2="23" y2="9"></line><line x1="20" y1="14" x2="23" y2="14"></line><line x1="1" y1="9" x2="4" y2="9"></line><line x1="1" y1="14" x2="4" y2="14"></line></svg>
                        </div>
                      </div>
                      <div class="">
                        <h3 class="mb-2">9 </h3>
                        <p>Implementados(87%)</p>
                        <div class="d-flex align-items-center gap-2">
                           <div class="widget-icon-small bg-light-danger text-danger">
                            +AI
                           </div>
                                                   <div class="progress flex-grow-1" style="height: 5px;">
                            <div class="progress-bar bg-gradient-info" role="progressbar" style="width: 82%;"></div>
                          </div>
                        </div>
                      </div>
                      <div id="chart4"></div>
                    </div>
                   </div>
                </div>
              </div>
            </div>
          </div>
        </div>

            <hr class="my-4">

            <h4>SmartQuail Crew  Asignado</h4>

        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-xl-3 row-cols-xxl-3">
  {% for member in staff %}
    <div class="col">
      <div class="card radius-10">
        <div class="card-body text-center">
          <div class="profile-img">
            {% if member.profile_picture %}
              <img src="{{ member.profile_picture.url }}" class="rounded-circle" width="120" height="120" alt="{{ member.full_name }}">
            {% else %}
              <img src="{% static 'images/default-profile.png' %}" class="rounded-circle" width="120" height="120" alt="Sin foto">
            {% endif %}
          </div>
          <div class="mt-4">
            <h5 class="mb-1">{{ member.full_name }}</h5>
            <p class="mb-0">{{ member.get_role_display }}</p>
          </div>
          <div class="d-flex align-items-center justify-content-around mt-4">
            <div class="">
              <h6 class="mb-0">{{ member.email }}</h6>
              <p class="mb-0 text-muted">Correo</p>
            </div>
            <div class="">
              <h6 class="mb-0">{{ member.phone }}</h6>
              <p class="mb-0 text-muted">Teléfono</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  {% empty %}
    <p class="text-muted">No hay miembros asignados al proyecto.</p>
  {% endfor %}
</div>


            {% if staff %}
              <ul class="list-group">
              {% for person in staff %}
                <li class="list-group-item">
                  <strong>{{ person.name }}</strong> – {{ person.role }}
                  <br><small>Email: {{ person.email }}</small>
                </li>
              {% endfor %}
              </ul>
            {% else %}
              <p class="text-muted">No hay personal asignado al proyecto.</p>
            {% endif %}
          </div>
        </div>

        
  {% for process in processes %}
  <div class="card mb-4 radius-10">
    <div class="card-header py-2">
      <div class="row row-cols-1 row-cols-lg-3">
        <div class="col">
          <small>Información del Proceso</small>
          <address class="m-t-5 m-b-5">
            <strong class="text-inverse">{{ process.name }}</strong><br>
            <small>{{ process.description }}</small><br>
            <strong>Progreso:</strong> {{ process.progress }}%<br>
            <strong>Tipo:</strong> {{ process.get_process_type_display }}<br>
            <strong>Clase:</strong> {{ process.get_process_class_display }}
          </address>
        </div>
        <div class="col">
          <small>Fechas</small>
          <address class="m-t-5 m-b-5">
            <strong>Inicio:</strong> {{ process.start_date|date:"d/m/Y" }}<br>
            <strong>Entrega:</strong> {{ process.delivery_date|date:"d/m/Y" }}<br>
            <strong>Días desarrollo:</strong> {{ process.total_development_days }} días<br>
            <strong>Aprobado:</strong> {{ process.approved_by_client|yesno:"Sí,No" }}
          </address>
        </div>
        <div class="col">
          <small>Automatización e IA</small>
          <div class="m-t-5 m-b-5">
            <strong>Automatización:</strong> {{ process.has_automation|yesno:"Sí,No" }}{% if process.has_automation %} - {{ process.automation_description }}{% endif %}<br>
            <strong>¿Usa IA?:</strong> {{ process.has_ai|yesno:"Sí,No" }}{% if process.has_ai %} - {{ process.ai_model_description }}{% endif %}
          </div>
        </div>
      </div>
    </div>

<div class="card-body">

  {% if process.progress == 100 %}
    <!-- Solo botón para visualizar -->
    {% if process.final_url %}
      <div class="text-center my-5">
        <a href="{{ process.final_url }}" target="_blank" class="btn btn-primary btn-lg">
          Visualizar Resultado Final
        </a>
      </div>
    {% else %}
      <p class="text-center text-warning my-5">No hay URL final disponible.</p>
    {% endif %}
  {% else %}
    <!-- Mostrar tabla con todos los detalles -->
    <div class="table-responsive">
      <table class="table table-invoice">
        <thead>
          <tr>
            <th>Descripción</th>
            <th class="text-center" width="15%">Tecnología</th>
            <th class="text-center" width="20%">Desarrollador</th>
            <th class="text-center" width="15%">QA Tests</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <span class="text-inverse">Detalles</span><br>
              <small>{{ process.description }}</small>
            </td>
            <td class="text-center">
              <span class="badge bg-info">{{ process.technology_type }}</span>
            </td>
            <td class="text-center">
              {% if process.assigned_developer %}
              <div class="d-flex flex-column align-items-center">
                <img src="{% if process.assigned_developer.profile_picture %}{{ process.assigned_developer.profile_picture.url }}{% else %}{% static 'images/default-avatar.png' %}{% endif %}" 
                     class="rounded-circle mb-1" width="40" height="40" alt="Foto perfil">
                <small><strong>{{ process.assigned_developer.full_name }}</strong></small>
                <small>{{ process.assigned_developer.get_role_display }}</small>
              </div>
              {% else %}
              <small class="text-muted"><em>No asignado</em></small>
              {% endif %}
            </td>
            <td class="text-center">
              {% if process.qa_tests.exists %}
                <ul class="list-unstyled small mb-0">
                  {% for test in process.qa_tests.all %}
                  <li>
                    <span class="badge {% if test.result == 'passed' %}bg-success{% elif test.result == 'failed' %}bg-danger{% else %}bg-warning text-dark{% endif %} mb-1">
                      {{ test.get_result_display }}
                    </span><br>
                    <small>{{ test.test_case }}</small>
                  </li>
                  {% endfor %}
                </ul>
              {% else %}
                <small class="text-muted">Sin pruebas QA</small>
              {% endif %}
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Ejemplo de resumen -->
    <div class="row bg-light align-items-center m-0">
      <div class="col col-auto p-3">
        <p class="mb-0" style="color:#fff;">Progreso</p>
        <div class="progress" style="height: 6px;">
          <div class="progress-bar bg-gradient-purple" role="progressbar" style="width: {{ process.progress }}%;"></div>
        </div>
        <p class="mb-0" style="color:#fff;">{{ process.progress }}%</p>
      </div>
      <div class="col col-auto me-auto p-3">
        <p class="mb-0" style="color:#fff;">Días totales</p>
        <h5 class="mb-0">{{ process.total_development_days }} días</h5>
      </div>
      <div class="col bg-primary col-auto p-3">
        <p class="mb-0 text-white">Aprobado</p>
        <h5 class="mb-0 text-white">{{ process.approved_by_client|yesno:"Sí,No" }}</h5>
      </div>
    </div>

    <hr>

    <div class="my-3 small text-muted">
      * Información sujeta a cambios según el avance del proyecto.<br>
      * Contactar con el administrador para más detalles.
    </div>
  {% endif %}
</div>

  </div>
  {% empty %}
  <p>No hay procesos definidos para este proyecto.</p>
  {% endfor %}
</div>